<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Chapter 0: Revision - LifetimeKata</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="index.html">Introduction</a></li><li class="chapter-item expanded "><a href="chapter_0.html" class="active">Chapter 0: Revision</a></li><li class="chapter-item expanded "><a href="chapter_1.html">Chapter 1: Lifetimes Needed</a></li><li class="chapter-item expanded "><a href="chapter_2.html">Chapter 2: Lifetimes Explained</a></li><li class="chapter-item expanded "><a href="chapter_3.html">Chapter 3: Lifetime Elision</a></li><li class="chapter-item expanded "><a href="chapter_4.html">Chapter 4: Mutable References and Containers</a></li><li class="chapter-item expanded "><a href="chapter_5.html">Chapter 5: Lifetimes on Types</a></li><li class="chapter-item expanded "><a href="chapter_6.html">Chapter 6: Lifetimes on Impls</a></li><li class="chapter-item expanded "><a href="chapter_7.html">Chapter 7: Special Lifetimes</a></li><li class="chapter-item expanded "><a href="chapter_8.html">Chapter 8: Finale</a></li><li class="chapter-item expanded "><a href="chapter_9.html">Chapter 9: Further Reading</a></li><li class="chapter-item expanded "><a href="chapter_10.html">Chapter 10: Footnote on Trait Lifetime Bounds</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">LifetimeKata</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/tfpk/lifetimekata/" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-0-references-and-lifetimes-revision"><a class="header" href="#chapter-0-references-and-lifetimes-revision">Chapter 0: References and Lifetimes Revision</a></h1>
<p><em>(This section is revision, and may be familiar to some readers.
If you already know what a reference is, you can skip it.)</em></p>
<p>If you've been using rust for a while, you've likely already encountered
references. For every type <code>T</code>, there are two types of references to it:</p>
<ul>
<li><code>&amp;T</code>: A shared reference (often called a shared borrow) of <code>T</code>. You can have
as many of these as you'd like, but they do not allow you to modify the 
data they refer to.</li>
<li><code>&amp;mut T</code>: A mutable reference (often called an exclusive borrow) of <code>T</code>.
You can only have one of these at a time, but they allow you to modify
the data they refer to.</li>
</ul>
<p>References make it easy to call a function on data
without needing to copy that data.</p>
<p>The powerful thing about Rust's references is that they are guaranteed to always
refer to something that still exists (i.e. has not been dropped/freed/gone out
of scope). A reference to something that no longer exists is called a &quot;dangling
reference&quot;, and Rust guarantees you will never have one. Therefore, this example
will not compile:</p>
<pre><code class="language-rust ignore">fn main() {
    let x_ref = {
        let x = 3;
        &amp;x
    };
    // x_ref would now refer to `x`, but `x` is out of scope, so x_ref is dangling.
   
    println!(&quot;{}&quot;, x_ref)
}</code></pre>
<p>Most modern languages (Python, Java, etc.) avoid the problem of dangling references
by constantly checking at runtime whether you have any references to something, and
dropping only when you have no references left. This is
called &quot;garbage collection&quot;, and the advantage of it is that you never need
to think about when objects dropped. The language just 
does it for you. The disadvantage is performance -- garbage collection requires
stopping your program occasionally for the language to scan every reference you have.</p>
<p>Some languages (notably C and Assembly) give you access to a
&quot;pointer&quot; type. Since pointers are raw addresses in memory, the compiler leaves
it to the programmer to ensure that they do not have dangling references. This
allows them to be used in memory constrained or performance critical
environments, but unfortunately means that a bug can access memory after it's
destroyed; resulting in a crash, or worse, a security issue.</p>
<p>Rust is powerful because it gives you the convenience of knowing at run-time
that you will never access freed memory; but the price you pay for this is
the compiler needing to be convinced at compile-time that you've
correctly used references.</p>
<h2 id="an-example-of-an-unconvinced-compiler"><a class="header" href="#an-example-of-an-unconvinced-compiler">An Example of an Unconvinced Compiler</a></h2>
<p>You've undoubtedly come across errors like the one below before:</p>
<pre><code class="language-rust ignore">fn main() {
    let mut my_reference: Option&lt;&amp;i32&gt; = None;

    // Starting a scope.
    {
        // my_variable created                               // \ \
        let my_variable: i32 = 7;                            // | |
        my_reference = Some(&amp;my_variable);                   // | |- my_variable exists here. ('variable)
        // At the end of the scope, `my_variable` is dropped // | |
        drop(my_variable);                                   // | |
        // my variable destroyed                             // | /
    }                                                        // | - my_reference needs to exist here. ('reference)
                                                             // |
    if let Some(reference) = my_reference {                  // |
        println!(&quot;{}&quot;, reference);                           // |
    }                                                        // /

}</code></pre>
<pre><code>error[E0597]: `my_variable` does not live long enough
  --&gt; bad_lifetimes.rs:7:29
   |
7  |         my_reference = Some(&amp;my_variable);
   |                             ^^^^^^^^^^^^ borrowed value does not live long enough
8  |     }
   |     - `my_variable` dropped here while still borrowed
9  |
10 |     if let Some(reference) = my_reference {
   |                              ------------ borrow later used here

error: aborting due to previous error; 1 warning emitted

</code></pre>
<p>Clearly in this example, since <code>my_variable</code> goes out of scope before <code>my_reference</code>,
it's possible that the <code>if let</code> could try and access <code>my_reference</code>, and find that
it's referencing a variable that no longer exists.</p>
<p>Rust says that this variable &quot;does not live long enough&quot;. It notices that
&quot;it's possible that <code>my_variable</code> is dropped before <code>my_reference</code>&quot;.</p>
<p>Formally, we can see this by noticing the regions of code where these two
variables need to exist. The region of code where the reference needs to exist
is <em>larger</em> than the region of code where the variable exists. This indicates
that there must be part of the time the reference exists where the variable
has been dropped, and therefore a dangling reference might exist.</p>
<p>We call a region of code where a variable exists a &quot;lifetime&quot;. We can
give lifetimes names using the syntax <code>'name</code>. So if we call the variable's
lifetime <code>'variable</code>, and the reference's lifetime <code>'reference</code>, we can
then formally say that for any variable that references another variable,
<code>'variable</code> must be larger than <code>'reference</code>.</p>
<h2 id="so-whats-this-book-about-then"><a class="header" href="#so-whats-this-book-about-then">So what's this book about then?</a></h2>
<p>There are places where the rust compiler is unable to figure out lifetimes, and
needs the programmer to explicitly specify this. This book is to help you
improve at writing explicit lifetimes (things like <code>&amp;'a str</code>). And that starts
with the next chapter!</p>
<h2 id="exercise-complete-the-rustlings-exercises-on-lifetimes"><a class="header" href="#exercise-complete-the-rustlings-exercises-on-lifetimes">Exercise: Complete the Rustlings Exercises on Lifetimes</a></h2>
<p>If you aren't sure you understand the above, before reading on,
<a href="https://github.com/rust-lang/rustlings/tree/main/exercises/lifetimes">complete the rustlings exercises about lifetimes</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="chapter_1.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="chapter_1.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
